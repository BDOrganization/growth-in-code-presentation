<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>The Evolution of the Devil's Snare</title>

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/moon.css">

        <!-- Custom CSS used to tweak theme -->
        <link rel="stylesheet" href="css/custom.css">

        <!-- Theme used for syntax highlighting of code; try switching to zenburn.css if comments don't show well -->
        <link rel="stylesheet" href="lib/css/monokai-sublime.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <h1>The Evolution of the Devil's Snare</h1>
                    <p>
                        <small>Created by Dustin Singleton and Brandon Rockhold</small>
                    </p>
                </section>
                <section>
                    <h2>Why this presentation?</h2>
                    <img src="http://vignette1.wikia.nocookie.net/harrypotter/images/e/e6/Tumblr_n0lq3f9gci1qdd90po8_r1_250.gif/revision/latest?cb=20140403212816" />
                    <ul>
                        <li>Poor APIs can strangle productivity</li>
                        <li>Many intelligent engineers don't always think in terms of APIs</li>
                        <li>Daily design decisions have long-reaching impacts</li>
                    </ul>
                    <aside class="notes">
                        <ul>
                            <li></li>
                            <li></li>
                        </ul>
                    </aside>
                </section>
                <section>
                    <h2>Why Should You Consider Listening to Us?</h2>
                    <ul>
                        <li>Software Architects with a combined tenure of 15+ years</li>
                        <li>
                            Designed/Reviewed/Refactored A LOT of code for a rapidly growing organization
                            <ul>
                                <li>...and experienced the pain associated with such rapid growth</li>
                            </ul>
                        </li>
                        <li>Passionate about clean code, API design, and being good code citizens in general</li>
                    </ul>
                </section>
                <section>
                    <h2>Overview / Goals</h2>
                    <ul>
                        <li>Discuss API designs which complicate/restrict ability to grow your code base</li>
                        <li>Provide passive transition paths for some* of these scenarios</li>
                        <li>Provide ACTIONABLE information that can be utilized IMMEDIATELY following the presentation</li>
                    </ul>
                    <br />
                    <br />
                    <small>* Only <em>some</em> of these scenarios, as we are unfortunately not wizards</small>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Poor Data Types / Data Type Abuse</h2>
                        <img src="http://i.imgur.com/XC08aVV.png" height=259 width=350 />
                    </section>
                    <section>
                        <h2>Poor Data Types / Data Type Abuse</h2>
                        <ul>
                            <li>Easy to misuse / Difficult to understand without additional doc</li>
                            <li>Lack proper means of validation, or at least complicate it</li>
                            <li>Place unnecessary burden on consumers (if they must parse or translate)</li>
                        </ul>
                    </section>
                    <section data-state="slide-with-code"'">
                        <h2>Poor Data Type Example</h2>
                        <pre>
                            <code data-trim>
public interface RecurringAppointment {
    /**
     * @return a string representing the days of the week. For the day of the week that
     *         the recurrence is on, an 'X' character will be present. For days of the
     *         week that there is no recurrence, a space character will be present.
     * 
     *         Ex: " XXXXX " (Monday - Friday) 
     *         
     *         Ex: " X X XX" (Mon/Wed/Fri/Sat)
     */
    String getWeeklyRecurrence();
}
                            </code>
                        </pre>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Consuming Poor Data Type Example</h2>
                        <pre>
                            <code data-trim>
public void consume(RecurringAppointment recurringAppointment) {
    String recurrence = recurringAppointment.getWeeklyRecurrence();
    for (int i = 0; i < recurrence.length(); i++) {
        char recurrenceChar = recurrence.charAt(i);
        if (recurrenceChar != 'X') {
            continue;
        }
        switch (i) {
            case 0:
                System.out.println("ASSUME SUNDAY");
                break;
            case 1:
                System.out.println("ASSUME MONDAY");
                break;
            ...
        }
    }
}
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li>The doc didn't indicate if case-sensitive, so cross your fingers!</li>
                                <li>Awkward zero-based indexing used for parsing days of week; Relies on API doc to indicate that it starts with Sunday vs Monday</li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Good Data Type Example</h2>
                        <pre>
                            <code data-trim>
public enum DayOfWeek {
    SUNDAY,
    MONDAY,
    ...
}

public interface RecurringAppointment {
    /**
     * @return the days of the week for which this appointment occurs.
     */
    Set&lt;DayOfWeek&gt; getWeeklyRecurrence();
}
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Consuming Good Data Type Example</h2>
                        <pre>
                            <code data-trim>
public void consume(RecurringAppointment recurringAppointment) {
    for (DayOfWeek dayOfWeek : recurringAppointment.getWeeklyRecurrence()) {
        switch (dayOfWeek) {
            case SUNDAY:
                System.out.println("DEFINITELY SUNDAY");
                break;
            case MONDAY:
                System.out.println("DEFINITELY MONDAY");
                break;
            ...
        }
    }
}
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Transition Example (Deprecation)</h2>
                        <pre>
                            <code data-trim>
@Deprecated
public String getWeeklyRecurrence() {
    return recurrence;
}

public Set&lt;DayOfWeek&gt; getWeeklyRecurrenceAsSet() {
    Set&lt;DayOfWeek&gt; daysOfWeekToReturn = new HashSet&lt;DayOfWeek&gt;();
    for (int i = 0; i < recurrence.length(); i++) {
        // logic to check char for non 'X' here...
        switch (i) {
            case 0:
                daysOfWeekToReturn.add(SUNDAY);
                break;
            ...
        }
    }
    return daysOfWeekToReturn;
}
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li>The example shown here is a non-passive change, however, as it replaces the getWeeklyRecurrence method's return type with a Set of DayOfWeek enum values</li>
                                <li>One passive transition option would be to add new API, such as 'getWeeklyRecurrenceAsSet' and have the implementation handle the messy details of translating the existing poor data type to the new good data type.</li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Transition Example (Wrapper)</h2>
                        <pre>
                            <code data-trim>
public class RecurringAppointmentWrapper {
    private final RecurringAppointment recurringAppointment;

    public RecurringAppointmentWrapper(RecurringAppointment recurringAppointment) {
        this.recurringAppointment = recurringAppointment;
    }

    public long getAppointmentId() {
        // Would have to proxy each method exposed by RecurrentAppointment...
        return recurringAppointment.getAppointmentId();
    }

    public Set&lt;DayOfWeek&gt; getWeeklyRecurrence() {
        ...
    }
}
                            </code>
                        </pre>
                        <aside class="notes">
                            <p>Benefits...</p>
                            <ul>
                                <li>Another passive transition would be to wrap the existing RecurringAppointment class with a new class that provides the desired API.</li>
                                <li>Results in less confusion and likely less defects once in use over the original class.</li>
                                <li>When functionality to replace is large, we may not have time to completely refactor. This approach provides consumers with a good API without creating even more debt to pay off in the future.</li>
                            </ul>
                            <p>Downsides...</p>
                            <ul>
                                <li>Each method necessary from the original class will have to be proxied through the wrapper.</li>
                                <li>If other APIs require usage of the original RecurringAppointment class, we'd have to expose API to get an instance of it from the wrapper.</li>
                                <li>Naming for these classes can be hard/awkward, as the best name may have already been taken by the original class.</li>
                            </ul>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Transition Example (Utility)</h2>
                        <pre>
                            <code data-trim>
// code goes here with no additional spaces
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li>A final transition example here is to take the messy/error-prone work out of consumers hands by providing them with a utility to do the work.</li>
                                <li></li>
                        </aside>
                    </section>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Easily Misused Collections API's</h2>
                        <img src="http://i.imgur.com/ZWCUEOD.png" height=350 width=279 />
                    </section>
                    <section>
                        <h2>Easily Misused Collections API's</h2>
                        <ul>
                            <li>DON'T return NULL collections</li>
                            <li>Growth in API consumption leads to LOTS of avoidable null checks</li>
                            <li>Someone absolutely WILL forget a null check somewhere</li>
                            <li>Iteration over returned collections is primary use-case; be nice to your consumers</li>
                            <li>ABSOLUTELY documented how the API behaves, even if you are evil</li>
                        </ul>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Evil Collections API Example</h2>
                        <pre>
                            <code data-trim data-noescape>
public class AppointmentManager {
    /**
     * Returns a collection of the available {@link Date}s that an appointment could
     * begin based on the date provided. If no appointment begin times can be found,
     * <mark>{@code null}</mark> will be returned.
     * 
     * @param startTime
     *            The first possible start date. This value will be used to determine
     *            the available begin dates.
     * @return a list of the available appointment begin dates.
     */
    public Collection&lt;Date&gt; getAvailableBeginTimes(Date startDate, Date endTime) {
        // logic!
    }
}
                            </code>
                        </pre>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Good Collections API Example</h2>
                        <pre>
                            <code data-trim data-noescape>
public class AppointmentManager {
    /**
     * Returns a collection of the available {@link Date}s that an appointment could
     * begin based on the date provided. If no appointment begin times can be found,
     * <mark>an empty collection</mark> will be returned.
     * 
     * @param startTime
     *            The first possible start date. This value will be used to determine
     *            the available begin dates.
     * @return a list of the available appointment begin dates.
     */
    public Collection&lt;Date&gt; getAvailableBeginTimes(Date startDate, Date endTime) {
        // logic!
    }
}
                            </code>
                        </pre>
                    </section>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Inconsistent State</h2>
                        <img src="http://i.imgur.com/PoMGuCG.png" height=263 width=350 />
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section>
                        <h2>Inconsistent State</h2>
                        <ul>
                            <li>...</li>
                            <li>...</li>
                        </ul>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Code Example Slide</h2>
                        <pre>
                            <code data-trim>
// code goes here with no additional spaces
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Weak Typing</h2>
                        <img src="http://i.imgur.com/0bFY1B5.png" height=257 width=350 />
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section>
                        <h2>Weak Typing</h2>
                        <ul>
                            <li>...</li>
                            <li>...</li>
                        </ul>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Code Example Slide</h2>
                        <pre>
                            <code data-trim>
// code goes here with no additional spaces
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Lack of Encapsulation</h2>
                        <img src="http://i.imgur.com/O2wXo9I.png" height=304 width=350 />
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section>
                        <h2>Lack of Encapsulation</h2>
                        <ul>
                            <li>...</li>
                            <li>...</li>
                        </ul>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Code Example Slide</h2>
                        <pre>
                            <code data-trim>
// code goes here with no additional spaces
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Growing Parameter List</h2>
                        <img src="http://i.imgur.com/DXZRJY7.png" height=263 width=350 />
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section>
                        <h2>Growing Parameter List</h2>
                        <ul>
                            <li>...</li>
                            <li>...</li>
                        </ul>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Code Example Slide</h2>
                        <pre>
                            <code data-trim>
// code goes here with no additional spaces
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Unnecessarily Restrictive Collections API's</h2>
                        // TODO Include img src and dimensions as appropriate
                        <img src="" height=350 width=350 />
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section>
                        <h2>Unnecessarily Restrictive Collections API's</h2>
                        <ul>
                            <li>...</li>
                            <li>...</li>
                        </ul>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Code Example Slide</h2>
                        <pre>
                            <code data-trim>
// code goes here with no additional spaces
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Unnecessarily Restrictive Validation</h2>
                        // TODO Include img src and dimensions as appropriate
                        <img src="" height=350 width=350 />
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section>
                        <h2>Unnecessarily Restrictive Validation</h2>
                        <ul>
                            <li>...</li>
                            <li>...</li>
                        </ul>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Code Example Slide</h2>
                        <pre>
                            <code data-trim>
// code goes here with no additional spaces
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Abstraction Leaks</h2>
                        <img src="http://i.imgur.com/YJJJ4b2.png" height=233 width=350 />
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section>
                        <h2>Abstraction Leaks</h2>
                        <ul>
                            <li>...</li>
                            <li>...</li>
                        </ul>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Code Example Slide</h2>
                        <pre>
                            <code data-trim>
// code goes here with no additional spaces
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Compiling Against Implementations</h2>
                        <img src="http://i.imgur.com/A9bGrQW.png" height=364 width=350 />
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section>
                        <h2>Compiling Against Implementations</h2>
                        <ul>
                            <li>...</li>
                            <li>...</li>
                        </ul>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Code Example Slide</h2>
                        <pre>
                            <code data-trim>
// code goes here with no additional spaces
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Burdening Consumers with Common Tasks</h2>
                        // TODO Include img src and dimensions as appropriate
                        <img src="" height=350 width=350 />
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section>
                        <h2>Burdening Consumers with Common Tasks</h2>
                        <ul>
                            <li>...</li>
                            <li>...</li>
                        </ul>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Code Example Slide</h2>
                        <pre>
                            <code data-trim>
// code goes here with no additional spaces
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                </section>
                <section>
                    <section data-background-color="#4d7e65">
                        <h2>Lack of Adapters</h2>
                        // TODO Include img src and dimensions as appropriate
                        <img src="" height=350 width=350 />
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section>
                        <h2>Lack of Adapters</h2>
                        <ul>
                            <li>...</li>
                            <li>...</li>
                        </ul>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                    <section data-state="slide-with-code">
                        <h2>Code Example Slide</h2>
                        <pre>
                            <code data-trim>
// code goes here with no additional spaces
                            </code>
                        </pre>
                        <aside class="notes">
                            <ul>
                                <li></li>
                                <li></li>
                        </aside>
                    </section>
                </section>
                <section>
                    <h1>Summary</h1>
                    <ul>
                        <li></li>
                        <li></li>
                    </ul>
                </section>
                <section>
                    <h1>Questions?</h1>
                </section>
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            // More info https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                history: true,

                transition: 'convex',

                // More info https://github.com/hakimel/reveal.js#dependencies
                dependencies: [
                    { src: 'plugin/markdown/marked.js' },
                    { src: 'plugin/markdown/markdown.js' },
                    { src: 'plugin/notes/notes.js', async: true },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                    { 
                        src: 'plugin/highlight/highlight.js', 
                        async: true, 
                        callback: function() {
                            hljs.configure({
                                languages: ['java']
                            });
                            hljs.initHighlightingOnLoad(); 
                        } 
                    }
                ]
            });
        </script>
    </body>
</html>
